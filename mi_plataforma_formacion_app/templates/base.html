<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>{% block title %}Gestor de Formación{% endblock %}</title>
<!-- Bootstrap CSS + Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
<!-- jQuery, jQuery UI y Select2: SIEMPRE antes de cualquier script -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<link href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
<style>
/* --- Paleta Soluciones Sanitarias: naranja solo en acentos, sidebar neutro --- */
/* Paleta profesional Soluciones Sanitarias */
:root {
  --color-sidebar-bg: #f4f5f7; /* gris piedra claro */
  --color-sidebar-border: #d1d5db; /* gris suave */
  --color-sidebar-text: #1a2233; /* navy muy oscuro */
  --color-sidebar-hover: #e9eaf0; /* gris más claro */
  --color-sidebar-active: #22305a; /* azul navy profundo */
  --color-sidebar-active-text: #fff;
  --color-sidebar-title: #bfa76a; /* dorado suave */
  --color-sidebar-icon: #bfa76a; /* dorado suave */
  --color-accent-gold: #bfa76a; /* dorado suave */
  --color-card-bg: #fff;
  --color-btn-gold: #bfa76a;
  --color-btn-navy: #22305a;
}
body {
  font-family: 'Segoe UI', sans-serif;
  background-color: #f4f5f7;
  margin: 0;
  padding: 0;
  color: var(--color-sidebar-text);
}
#sidebar {
  width: 240px;
  background-color: var(--color-sidebar-bg);
  border-right: 1.5px solid var(--color-sidebar-border);
  height: 100vh;
  position: fixed;
  padding-top: 1rem;
  padding-bottom: 40px !important;
  overflow-y: auto;
  z-index: 1000;
  box-shadow: 2px 0 16px #22305a0d;
}
#sidebar ul.nav {
  margin-bottom: 48px !important;
}
#sidebar .sidebar-title {
  text-align: center;
  font-size: 1.5rem;
  color: var(--color-sidebar-title);
  font-weight: bold;
  margin-bottom: 1.1rem;
  letter-spacing: 0.5px;
  text-shadow: 0 2px 8px #bfa76a22, 0 1px 0 #bfa76a22;
}
#sidebar .nav-link {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 18px;
  border-radius: 8px;
  margin: 4px 12px;
  color: var(--color-sidebar-text);
  text-decoration: none;
  font-weight: 500;
  transition: background 0.18s, color 0.18s, box-shadow 0.18s;
  box-shadow: 0 1px 4px #22305a08;
}
#sidebar .nav-link i {
  color: var(--color-sidebar-icon);
  opacity: 0.85;
}
#sidebar .nav-link:hover {
  background: var(--color-sidebar-hover);
  color: var(--color-sidebar-active);
  box-shadow: 0 2px 8px #22305a22;
}
#sidebar .nav-link:hover i {
  color: var(--color-sidebar-active);
}
#sidebar .nav-link.active-nav {
  background: var(--color-sidebar-active);
  color: var(--color-sidebar-active-text) !important;
  font-weight: 700;
  box-shadow: 0 4px 18px #22305a33;
}
#sidebar .nav-link.active-nav i {
  color: #fff;
}
#sidebar .nav-group-title {
  font-size: 0.85rem;
  text-transform: uppercase;
  padding: 7px 18px 4px 18px;
  font-weight: 700;
  color: #bfa76a;
  letter-spacing: 0.5px;
}
.logo {
  display: block;
  width: 54px;
  height: auto;
  margin: 0 auto 10px;
  border-radius: 12px;
  box-shadow: 0 2px 12px #bfa76a22;
  background: #fff;
  padding: 6px;
}
main {
  margin-left: 250px;
  padding: 30px;
}
footer {
  margin-top: 40px;
  padding: 20px;
  text-align: center;
  color: #22305a;
  font-weight: 700;
  letter-spacing: 0.5px;
  font-size: 1.08rem;
  background: #f4f5f7;
  border-top: 1.5px solid #d1d5db;
}
@media (max-width: 991px) {
  #sidebar {
    padding-bottom: 60px !important;
  }
}
</style>

  {% block head %}{% endblock %}
</head>
<body>
<!-- Sidebar -->
<nav id="sidebar">
<img alt="Logo" class="logo" src="{{ url_for('static', filename='logo.png') }}"/>
<div class="sidebar-title">Gestor Formación</div>
<ul class="nav flex-column">
  {# Eliminadas entradas duplicadas de administración, solo quedan en Configuración #}
  <li class="nav-group-title">Inicio</li>
  <li><a class="nav-link {% if request.endpoint == 'main_bp.index' %}active-nav{% endif %}" href="{{ url_for('main_bp.index') }}">
    <i class="bi bi-house-door-fill"></i> Inicio</a></li>

  <li class="nav-group-title">Alumnos</li>
  <li><a class="nav-link {% if request.endpoint == 'alumnos_bp.lista_alumnos' %}active-nav{% endif %}" href="{{ url_for('alumnos_bp.lista_alumnos') }}">
    <i class="bi bi-people"></i> Alumnos</a></li>
  <li><a class="nav-link {% if request.endpoint == 'alumnos_bp.acceso_formacion' %}active-nav{% endif %}" href="{{ url_for('alumnos_bp.acceso_formacion') }}">
    <i class="bi bi-door-open"></i> Acceso Formación</a></li>

  <li><a class="nav-link {% if request.endpoint == 'caducidades_bp.listado_caducidades' %}active-nav{% endif %}" href="{{ url_for('caducidades_bp.listado_caducidades') }}">
    <i class="bi bi-exclamation-triangle-fill"></i> Caducidades</a></li>

  <li class="nav-group-title">Empresa</li>
  <li><a class="nav-link {% if request.endpoint.startswith('empresas_') %}active-nav{% endif %}" href="{{ url_for('empresas_bp.gestion_empresas') }}">
    <i class="bi bi-building"></i> Empresas</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('comerciales_') %}active-nav{% endif %}" href="{{ url_for('comerciales_bp.gestion_comerciales') }}">
    <i class="bi bi-person-badge"></i> Comerciales</a></li>

  <li class="nav-group-title">Formaciones</li>
  <li><a class="nav-link {% if request.endpoint.startswith('tipo_curso_') %}active-nav{% endif %}" href="{{ url_for('tipo_curso_bp.gestion_tipo_curso') }}">
    <i class="bi bi-book"></i> Tipos de curso</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('formaciones_') and 'gestion_formaciones' in request.endpoint %}active-nav{% endif %}" href="{{ url_for('formaciones_bp.gestion_formaciones') }}">
    <i class="bi bi-calendar-week"></i> Formaciones</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('formadores_') %}active-nav{% endif %}" href="{{ url_for('formadores_bp.gestion_formadores') }}">
    <i class="bi bi-person-vcard"></i> Formadores</a></li>
  <li><a class="nav-link {% if request.endpoint == 'formaciones_bp.calendario_formaciones' %}active-nav{% endif %}" href="{{ url_for('formaciones_bp.calendario_formaciones') }}">
    <i class="bi bi-calendar-event"></i> Calendario</a></li>
  <li><a class="nav-link {% if request.endpoint == 'formaciones_bp.diplomas_emitidos' %}active-nav{% endif %}" href="{{ url_for('formaciones_bp.diplomas_emitidos') }}">
    <i class="bi bi-award"></i> Diplomas emitidos</a></li>

  <li class="nav-group-title">Configuración</li>
  <li><a class="nav-link {% if request.endpoint.startswith('usuarios_bp') %}active-nav{% endif %}" href="{{ url_for('usuarios_bp.lista_usuarios') }}">
    <i class="bi bi-person-lines-fill"></i> Crear/gestionar usuarios</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('login_attempts_bp') %}active-nav{% endif %}" href="{{ url_for('login_attempts_bp.view_attempts') }}">
    <i class="bi bi-shield-lock"></i> Intentos de acceso</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('reset_password_bp') %}active-nav{% endif %}" href="{{ url_for('reset_password_bp.reset_password') }}">
    <i class="bi bi-key"></i> Restablecer contraseña</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('auth_bp') %}active-nav{% endif %}" href="{{ url_for('auth_bp.login') }}">
    <i class="bi bi-box-arrow-in-right"></i> Acceso usuarios</a></li>
  <li class="nav-group-title" style="font-size:0.9rem; color:#22305a;">Email</li>
  <li><a class="nav-link {% if request.endpoint == 'email_config_bp.config_email' %}active-nav{% endif %}" href="{{ url_for('email_config_bp.config_email') }}">
    <i class="bi bi-envelope-at"></i> Configuración email</a></li>
  <li><a class="nav-link {% if request.endpoint == 'email_template_bp.config_email_template' %}active-nav{% endif %}" href="{{ url_for('email_template_bp.config_email_template') }}">
    <i class="bi bi-envelope-paper"></i> Plantilla email diploma</a></li>
  <li class="nav-group-title" style="font-size:0.9rem; color:#22305a;">Plantillas PDF</li>
  <li><a class="nav-link {% if request.endpoint.startswith('diplomas_bp') %}active-nav{% endif %}" href="{{ url_for('diplomas_bp.listar_plantillas') }}">
    <i class="bi bi-award-fill"></i> Plantillas diplomas</a></li>
  <li><a class="nav-link {% if request.endpoint.startswith('plantillas_acta_bp') %}active-nav{% endif %}" href="{{ url_for('plantillas_acta_bp.listar') }}">
    <i class="bi bi-file-earmark-richtext"></i> Plantillas actas</a></li>
  <li class="nav-group-title" style="font-size:0.9rem; color:#22305a;">Otros</li>
  <li><a class="nav-link {% if request.endpoint == 'examenes_bp.listar_examenes_modelo' %}active-nav{% endif %}" href="{{ url_for('examenes_bp.listar_examenes_modelo') }}">
    <i class="bi bi-ui-checks"></i> Crear exámenes</a></li>

</ul>
{% if session.get('user_id') %}
  <div style="padding: 0 18px 18px 18px;">
    <a class="btn btn-outline-danger w-100" href="{{ url_for('auth_bp.logout') }}">
      <i class="bi bi-box-arrow-right"></i> Cerrar sesión
    </a>
  </div>
{% endif %}
</nav>
<!-- Sidebar toggler (mobile) -->
<button class="btn btn-outline-light" id="sidebar-toggler">
<i class="bi bi-list"></i>
</button>
<!-- Main content -->
<main>
    {% block content %}{% endblock %}
  </main>
<!-- Footer -->
<footer style="margin-top:40px; padding:20px; text-align:center; color:var(--color-sidebar-title); font-weight:700; letter-spacing:0.5px; font-size:1.08rem; background:var(--color-sidebar-bg); border-top:2px solid var(--color-sidebar-border); box-shadow:0 -2px 16px #22305a0d;">
    <span style="color:var(--color-sidebar-active); font-size:1.13rem; letter-spacing:0.7px; font-family:'Segoe UI',sans-serif; font-weight:800;">Gestor de Formación</span>
    <span style="color:var(--color-sidebar-title); font-size:1.08rem; font-weight:600; margin-left:8px;">· Soluciones Sanitarias</span>
</footer>
<!-- Bootstrap JS (después de jQuery siempre) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Toggle sidebar on mobile
    const sidebar = document.getElementById('sidebar');
    const toggler = document.getElementById('sidebar-toggler');
    toggler.addEventListener('click', () => sidebar.classList.toggle('show'));
    document.addEventListener('click', e => {
      if (window.innerWidth < 992 && !sidebar.contains(e.target) && !toggler.contains(e.target)) {
        sidebar.classList.remove('show');
      }
    });
  </script>
  {% block scripts %}{% endblock %}
</body>
</html>

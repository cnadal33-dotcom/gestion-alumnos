{% extends "base.html" %}
{% block content %}
<div class="container-lg">
  <div class="card shadow-lg border-0 mt-4" style="border-radius:1rem;">
    <div class="card-header d-flex flex-column flex-md-row align-items-center justify-content-between pb-0" style="background: var(--color-sidebar-active); color: var(--color-sidebar-title); border-top-left-radius: 1rem; border-top-right-radius: 1rem; border-bottom: none;">
      <div class="d-flex align-items-center mb-2 mb-md-0">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" style="max-height:44px; margin-right:16px; background:#fff; border-radius:10px; box-shadow:0 2px 8px #bfa76a22; padding:4px;">
        <h2 class="mb-0 fw-bold" style="color:var(--color-sidebar-title); text-shadow:0 2px 8px #bfa76a22,0 1px 0 #bfa76a22;"><i class="bi bi-person-badge"></i> Comerciales</h2>
      </div>
      <div class="d-flex gap-2 flex-wrap">
        <a href="{{ url_for('comerciales_bp.nuevo_comercial') }}" class="btn btn-outline-warning btn-sm rounded-pill px-4 fw-semibold" style="border-color:var(--color-accent-gold);color:var(--color-accent-gold);font-weight:600;">
          <i class="bi bi-plus-circle"></i> Nuevo comercial
        </a>
      </div>
    </div>
    <div class="card-body" style="background:#fff; border-bottom-left-radius:1rem; border-bottom-right-radius:1rem;">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th style="width: 30%;">Nombre</th>
              <th style="width: 35%;">Email</th>
              <th style="width: 18%;">Teléfono</th>
              <th style="width: 17%;">Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for comercial in comerciales %}
            <tr>
              <td class="text-truncate" style="max-width: 250px;" title="{{ comercial.nombre }}">{{ comercial.nombre }}</td>
              <td class="text-truncate" style="max-width: 280px;" title="{{ comercial.email }}">{{ comercial.email }}</td>
              <td class="text-truncate" style="max-width: 130px;" title="{{ comercial.telefono }}">{{ comercial.telefono }}</td>
              <td>
                <div class="d-flex gap-1 flex-wrap">
                  <!-- Ficha de comercial -->
                  <a href="{{ url_for('comerciales_bp.ficha_comercial', comercial_id=comercial.id) }}"
                     class="btn btn-info btn-sm"
                     data-bs-toggle="tooltip" title="Ver ficha">
                    <i class="bi bi-person-lines-fill"></i>
                  </a>
                  <!-- Editar -->
                  <a href="{{ url_for('comerciales_bp.editar_comercial', id=comercial.id) }}"
                     class="btn btn-outline-primary btn-sm"
                     data-bs-toggle="tooltip" title="Editar">
                    <i class="bi bi-pencil"></i>
                  </a>
                  <!-- Borrar -->
                  <form action="{{ url_for('comerciales_bp.borrar_comercial', id=comercial.id) }}" method="post"
                        onsubmit="return confirm('¿Seguro que quieres borrar este comercial?');" style="display:inline;">
                    <button type="submit" class="btn btn-outline-danger btn-sm" data-bs-toggle="tooltip" title="Borrar">
                      <i class="bi bi-trash"></i>
                    </button>
                  </form>
                </div>
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="4" class="text-center text-muted">No hay comerciales registrados.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
    </div>
  </div>
</div>

<script>
  // Activa los tooltips de Bootstrap
  var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl)
  })
</script>
{% endblock %}
